<div class="relative w-full py-4 px-2 z-[100]">
  <div class="navbar flex-wrap w-full justify-center p-4 bg-black/30 backdrop-blur-sm rounded-full">
    <div class="flex">
      <a class="btn btn-ghost text-xl hover:bg-transparent" href="/">

        <img src="/static/images/logo-sm.png" alt="Sons of the Forest Mods" class="max-h-8">
        {# <img src="/static/images/logo.png" alt="logo" class="h-10"> #}
        {# <span class="text-xl hidden sm:block">Sons of the Forest Mods</span> #}
      </a>
    </div>
    <div class="flex flex-grow justify-center items-center">
      <ul class="menu bg-gray-800/80 menu-horizontal rounded-box">
        <li>
          <a href="/mods">
            <svg class="w-5 h-5 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
              <path fill-rule="evenodd" d="M20 10H4v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8ZM9 13v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1Z" clip-rule="evenodd"/>
              <path d="M2 6a2 2 0 0 1 2-2h16a2 2 0 1 1 0 4H4a2 2 0 0 1-2-2Z"/>
            </svg>

        Mods
        {# <span class="badge badge-sm">99+</span> #}</a>
        </li>
        <li>
          <a href="/builds">
            <svg class="w-5 h-5 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
              <path fill-rule="evenodd" d="M11.293 3.293a1 1 0 0 1 1.414 0l6 6 2 2a1 1 0 0 1-1.414 1.414L19 12.414V19a2 2 0 0 1-2 2h-3a1 1 0 0 1-1-1v-3h-2v3a1 1 0 0 1-1 1H7a2 2 0 0 1-2-2v-6.586l-.293.293a1 1 0 0 1-1.414-1.414l2-2 6-6Z" clip-rule="evenodd"/>
            </svg>

        Builds
        <span class="badge badge-sm badge-warning">NEW</span>
          </a>
        </li>
        <li>
          <a href="https://discord.gg/sotf" target="_blank">
            <svg class="w-5 h-5 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
              <path d="M18.942 5.556a16.3 16.3 0 0 0-4.126-1.3 12.04 12.04 0 0 0-.529 1.1 15.175 15.175 0 0 0-4.573 0 11.586 11.586 0 0 0-.535-1.1 16.274 16.274 0 0 0-4.129 1.3 17.392 17.392 0 0 0-2.868 11.662 15.785 15.785 0 0 0 4.963 2.521c.41-.564.773-1.16 1.084-1.785a10.638 10.638 0 0 1-1.706-.83c.143-.106.283-.217.418-.331a11.664 11.664 0 0 0 10.118 0c.137.114.277.225.418.331-.544.328-1.116.606-1.71.832a12.58 12.58 0 0 0 1.084 1.785 16.46 16.46 0 0 0 5.064-2.595 17.286 17.286 0 0 0-2.973-11.59ZM8.678 14.813a1.94 1.94 0 0 1-1.8-2.045 1.93 1.93 0 0 1 1.8-2.047 1.918 1.918 0 0 1 1.8 2.047 1.929 1.929 0 0 1-1.8 2.045Zm6.644 0a1.94 1.94 0 0 1-1.8-2.045 1.93 1.93 0 0 1 1.8-2.047 1.919 1.919 0 0 1 1.8 2.047 1.93 1.93 0 0 1-1.8 2.045Z"/>
            </svg>
        Discord
        {# <span class="badge badge-xs badge-info"></span> #}</a>
        </li>
      </ul>
    </div>
    <div class="flex justify-center items-center px-2 gap-2">
      {# Snow toggle button - only visible in December #}
      <button
        id="snow-toggle-btn"
        class="btn btn-ghost btn-circle hidden"
        onclick="if (typeof window.toggleSnowEffect === 'function') { window.toggleSnowEffect(); } else { console.warn('Snow toggle not ready yet'); }"
        aria-label="Toggle snow effect"
        aria-pressed="false"
        title="Toggle snow effect">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 2v2m0 16v2M4.93 4.93l1.41 1.41m11.32 11.32l1.41 1.41M2 12h2m16 0h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41M17.66 17.66l-1.41-1.41M4.93 19.07l-1.41-1.41M12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6 6 6 0 0 1-6-6 6 6 0 0 1 6-6z"></path>
        </svg>
      </button>
      <div class="dropdown dropdown-end">
        <label class="btn btn-ghost btn-circle uppercase" tabindex="0">
          {{ "中文" if lang == 'ch' else lang }}
        </label>
        <ul class="menu menu-sm dropdown-content bg-base-100 rounded-box w-52 p-2 shadow" tabindex="0">
          {% for language in languages %}
            <li class="menu-item">
              <a href="#" onclick='cookieStore.set("lang", "{{ language.code }}").then(() => location.reload()).catch(err => console.error(err))'>
                {% if lang == language.code %}
                  <span class="text-primary">
                    {{ language.name }}
                  </span>
                {% else %}
                  {{ language.name }}
                {% endif %}
              </a>
            </li>
          {% endfor %}
        </ul>
      </div>
      <div class="dropdown dropdown-end">
        <div tabindex="0" role="button" class="btn btn-ghost btn-circle avatar flex justify-center items-center">
            {% if user and user.imageUrl %}
              <div class="w-10 rounded-full">
                <img
                  alt="{{ user.name }}"
                  class="w-full h-full object-cover rounded-full"
                  src="{{ user.imageUrl }}"/>
              </div>
            {% else %}
              <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                <path fill-rule="evenodd" d="M12 4a4 4 0 1 0 0 8 4 4 0 0 0 0-8Zm-2 9a4 4 0 0 0-4 4v1a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-1a4 4 0 0 0-4-4h-4Z" clip-rule="evenodd"/>
              </svg>
            {% endif %}
        </div>
        <ul
          tabindex="0"
          class="menu menu-sm dropdown-content bg-base-100 rounded-box w-52 p-2 shadow">
          {% if user %}
            <li>
              <a class="disabled" href="/profile/{{ user.slug }}">{{ user.name }}</a>
            </li>
            <li>
              <a href="/profile/{{ user.slug }}">{{ _("_navbar.profile") }}</a>
            </li>
            <li>
              <a class="justify-between" href="/upload">
                {{ _("_navbar.upload") }}
              </a>
            </li>
            <li>
              <a class="justify-between" href="/upload-build">
                {{ _("_navbar.upload_build") }}
                <span class="badge">{{ _("_navbar.new") }}</span>
              </a>
            </li>
            <li>
              <a href="/logout" onclick="event.preventDefault(); (async () => { function getToken() { const cookies = document.cookie.split(';'); for (let c of cookies) { const [name, val] = c.trim().split('='); if (name === 'token') return decodeURIComponent(val); } return localStorage.getItem('token'); } const token = getToken(); if (token) { try { await fetch(`${PUBLIC_API_URL}/api/auth/logout`, { method: 'POST', headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' }, credentials: 'include' }); } catch(e) {} document.cookie = 'token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT'; localStorage.removeItem('token'); } window.location.href = '/login'; })();">{{ _("_navbar.logout") }}</a>
            </li>
          {% else %}
            <li class="menu-item">
              <a href="/login">{{ _("_navbar.login") }}</a>
            </li>
            <li class="menu-item">
              <a href="/register">{{ _("_navbar.register") }}</a>
            </li>
          {% endif %}
        </ul>
      </div>
    </div>
  </div>
</div>